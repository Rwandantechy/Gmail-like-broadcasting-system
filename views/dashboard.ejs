<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="/styles/clock.css" />
    <link rel="stylesheet" href="/styles/dashboard.css" />

    <script
      src="https://kit.fontawesome.com/56c42c8616.js"
      crossorigin="anonymous"
    ></script>
    <script src="/js/tinymce.min.js" referrerpolicy="origin"></script>
    <title>Nishkaam:: Dashboard</title>
    <style>
      .all-body {
        overflow: hidden;
        overflow-y: hidden;
      }
      .all-body::-webkit-scrollbar {
        display: none;
      }

      .main-content {
        flex-grow: 1;
        overflow-y: auto;
        max-height: calc(100vh - 120px);
      }
      #composeEmailModal {
        display: none;
        position: absolute;
        max-height: calc(100vh - 30px);
        top: 60% !important;
        left: 50%;
        overflow-y: auto;
        flex-grow: 2;
        transform: translate(-50%, -50%);
        z-index: 1000;
      }
    </style>
  </head>
  <!-- body start here -->
  <body
    class="bg-gradient-to-b from-green-900 via-yellow-100 to-purple-100 min-h-screen"
  >
    <!-- main section here -->
    <main>
      <%- include('./partials/header.ejs') %>
      <!--  the main content starts here  -->
      <section class="all-body flex flex-col md:flex-row pt-20">
        <%- include('./partials/menu.ejs') %>
        <!--  the body content of starts here  -->
        <section
          class="main-content w-full md:w-4/5 h-full p-4 bg-gray-200 m-3 rounded-xl shadow-2xl"
        >
          <%- include('./partials/compose.ejs') %>

          <div
            class="flex flex-col bg-white p-2 rounded-lg hover:bg-gray-300 transition duration-300 ease-in-out mb-2"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <input type="checkbox" class="mr-2" />
                <span class="font-semibold">Nishkaam Innovations</span>
                <p class="text-sm text-gray-600 ml-2">
                  You have been selected for an interview at Nishkaam
                  Innovations.
                </p>
              </div>

              <div class="flex items-center">
                <span class="text-sm text-gray-500 mr-2"
                  >11:30 AM, Tue, Jan 25, 2024</span
                >

                <i class="fas fa-ellipsis-v text-gray-500"></i>
              </div>
            </div>
          </div>
          <div
            class="flex flex-col bg-white p-2 rounded-lg hover:bg-gray-300 transition duration-300 ease-in-out mb-2"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <input type="checkbox" class="mr-2" />
                <span class="font-semibold">Nishkaam Innovations</span>
                <p class="text-sm text-gray-600 ml-2">
                  You have been selected for an interview at Nishkaam
                  Innovations.
                </p>
              </div>

              <div class="flex items-center">
                <span class="text-sm text-gray-500 mr-2"
                  >11:30 AM, Tue, Jan 25, 2024</span
                >

                <i class="fas fa-ellipsis-v text-gray-500"></i>
              </div>
            </div>
          </div>
          <div
            class="flex flex-col bg-white p-2 rounded-lg hover:bg-gray-300 transition duration-300 ease-in-out mb-2"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <input type="checkbox" class="mr-2" />
                <span class="font-semibold">Nishkaam Innovations</span>
                <p class="text-sm text-gray-600 ml-2">
                  You have been selected for an interview at Nishkaam
                  Innovations.
                </p>
              </div>

              <div class="flex items-center">
                <span class="text-sm text-gray-500 mr-2"
                  >11:30 AM, Tue, Jan 25, 2024</span
                >

                <i class="fas fa-ellipsis-v text-gray-500"></i>
              </div>
            </div>
          </div>
          <div
            class="flex flex-col bg-white p-2 rounded-lg hover:bg-gray-300 transition duration-300 ease-in-out mb-2"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <input type="checkbox" class="mr-2" />
                <span class="font-semibold">Nishkaam Innovations</span>
                <p class="text-sm text-gray-600 ml-2">
                  You have been selected for an interview at Nishkaam
                  Innovations.
                </p>
              </div>

              <div class="flex items-center">
                <span class="text-sm text-gray-500 mr-2"
                  >11:30 AM, Tue, Jan 25, 2024</span
                >

                <i class="fas fa-ellipsis-v text-gray-500"></i>
              </div>
            </div>
          </div>
          <div
            class="flex flex-col bg-white p-2 rounded-lg hover:bg-gray-300 transition duration-300 ease-in-out mb-2"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <input type="checkbox" class="mr-2" />
                <span class="font-semibold">Nishkaam Innovations</span>
                <p class="text-sm text-gray-600 ml-2">
                  You have been selected for an interview at Nishkaam
                  Innovations.
                </p>
              </div>

              <div class="flex items-center">
                <span class="text-sm text-gray-500 mr-2"
                  >11:30 AM, Tue, Jan 25, 2024</span
                >

                <i class="fas fa-ellipsis-v text-gray-500"></i>
              </div>
            </div>
          </div>
          <div
            class="flex flex-col bg-white p-2 rounded-lg hover:bg-gray-300 transition duration-300 ease-in-out mb-2"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <input type="checkbox" class="mr-2" />
                <span class="font-semibold">Nishkaam Innovations</span>
                <p class="text-sm text-gray-600 ml-2">
                  You have been selected for an interview at Nishkaam
                  Innovations.
                </p>
              </div>

              <div class="flex items-center">
                <span class="text-sm text-gray-500 mr-2"
                  >11:30 AM, Tue, Jan 25, 2024</span
                >

                <i class="fas fa-ellipsis-v text-gray-500"></i>
              </div>
            </div>
          </div>
          <div
            class="flex flex-col bg-white p-2 rounded-lg hover:bg-gray-300 transition duration-300 ease-in-out mb-2"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <input type="checkbox" class="mr-2" />
                <span class="font-semibold">Nishkaam Innovations</span>
                <p class="text-sm text-gray-600 ml-2">
                  You have been selected for an interview at Nishkaam
                  Innovations.
                </p>
              </div>

              <div class="flex items-center">
                <span class="text-sm text-gray-500 mr-2"
                  >11:30 AM, Tue, Jan 25, 2024</span
                >

                <i class="fas fa-ellipsis-v text-gray-500"></i>
              </div>
            </div>
          </div>
          <div
            class="flex flex-col bg-white p-2 rounded-lg hover:bg-gray-300 transition duration-300 ease-in-out mb-2"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <input type="checkbox" class="mr-2" />
                <span class="font-semibold">Nishkaam Innovations</span>
                <p class="text-sm text-gray-600 ml-2">
                  You have been selected for an interview at Nishkaam
                  Innovations.
                </p>
              </div>

              <div class="flex items-center">
                <span class="text-sm text-gray-500 mr-2"
                  >11:30 AM, Tue, Jan 25, 2024</span
                >

                <i class="fas fa-ellipsis-v text-gray-500"></i>
              </div>
            </div>
          </div>
          <div
            class="flex flex-col bg-white p-2 rounded-lg hover:bg-gray-300 transition duration-300 ease-in-out mb-2"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <input type="checkbox" class="mr-2" />
                <span class="font-semibold">Nishkaam Innovations</span>
                <p class="text-sm text-gray-600 ml-2">
                  You have been selected for an interview at Nishkaam
                  Innovations.
                </p>
              </div>

              <div class="flex items-center">
                <span class="text-sm text-gray-500 mr-2"
                  >11:30 AM, Tue, Jan 25, 2024</span
                >

                <i class="fas fa-ellipsis-v text-gray-500"></i>
              </div>
            </div>
          </div>
          <div
            class="flex flex-col bg-white p-2 rounded-lg hover:bg-gray-300 transition duration-300 ease-in-out mb-2"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <input type="checkbox" class="mr-2" />
                <span class="font-semibold">Nishkaam Innovations</span>
                <p class="text-sm text-gray-600 ml-2">
                  You have been selected for an interview at Nishkaam
                  Innovations.
                </p>
              </div>

              <div class="flex items-center">
                <span class="text-sm text-gray-500 mr-2"
                  >11:30 AM, Tue, Jan 25, 2024</span
                >

                <i class="fas fa-ellipsis-v text-gray-500"></i>
              </div>
            </div>
          </div>
          <div
            class="flex flex-col bg-white p-2 rounded-lg hover:bg-gray-300 transition duration-300 ease-in-out mb-2"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <input type="checkbox" class="mr-2" />
                <span class="font-semibold">Nishkaam Innovations</span>
                <p class="text-sm text-gray-600 ml-2">
                  You have been selected for an interview at Nishkaam
                  Innovations.
                </p>
              </div>

              <div class="flex items-center">
                <span class="text-sm text-gray-500 mr-2"
                  >11:30 AM, Tue, Jan 25, 2024</span
                >

                <i class="fas fa-ellipsis-v text-gray-500"></i>
              </div>
            </div>
          </div>
          <div
            class="flex flex-col bg-white p-2 rounded-lg hover:bg-gray-300 transition duration-300 ease-in-out mb-2"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <input type="checkbox" class="mr-2" />
                <span class="font-semibold">Nishkaam Innovations</span>
                <p class="text-sm text-gray-600 ml-2">
                  You have been selected for an interview at Nishkaam
                  Innovations.
                </p>
              </div>

              <div class="flex items-center">
                <span class="text-sm text-gray-500 mr-2"
                  >11:30 AM, Tue, Jan 25, 2024</span
                >

                <i class="fas fa-ellipsis-v text-gray-500"></i>
              </div>
            </div>
          </div>
        </section>
        <!--the  body content ends here -->
      </section>
      <!-- main content ends here  -->
    </main>
    <!--main section ends here   -->
  </body>
  <!-- body ends here  -->

  <!-- Modals start here  -->

  <!-- scripts here  -->
  <!-- Actions -->

  <script>
    tinymce.init({
      selector: "textarea",
      plugins:
        "ai tinycomments mentions anchor autolink charmap codesample emoticons image link lists media searchreplace table visualblocks wordcount checklist mediaembed casechange export formatpainter pageembed permanentpen footnotes advtemplate advtable advcode editimage tableofcontents mergetags powerpaste tinymcespellchecker autocorrect a11ychecker typography inlinecss",
      toolbar:
        "undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table mergetags | align lineheight | tinycomments | checklist numlist bullist indent outdent | emoticons charmap | removeformat",
      tinycomments_mode: "embedded",
      tinycomments_author: "Author name",
      mergetags_list: [
        { value: "First.Name", title: "First Name" },
        { value: "Email", title: "Email" },
      ],
      ai_request: (request, respondWith) =>
        respondWith.string(() =>
          Promise.reject("See docs to implement AI Assistant")
        ),
    });
  </script>
  <script>
    const displayTime = document.querySelector(".display-time");
    // Time
    function showTime() {
      let time = new Date();
      displayTime.innerText = time.toLocaleTimeString("en-US", {
        hour12: false,
      });
      setTimeout(showTime, 1000);
    }

    showTime();

    // Date
    function updateDate() {
      let today = new Date();

      // return number
      let dayName = today.getDay(),
        dayNum = today.getDate(),
        month = today.getMonth(),
        year = today.getFullYear();

      const months = [
        "January",
        "February",
        "March",
        "April",
        "May",
        "June",
        "July",
        "August",
        "September",
        "October",
        "November",
        "December",
      ];
      const dayWeek = [
        "Sunday",
        "Monday",
        "Tuesday",
        "Wednesday",
        "Thursday",
        "Friday",
        "Saturday",
      ];
      // value -> ID of the html element
      const IDCollection = ["day", "daynum", "month", "year"];
      // return value array with number as a index
      const val = [dayWeek[dayName], dayNum, months[month], year];
      for (let i = 0; i < IDCollection.length; i++) {
        document.getElementById(IDCollection[i]).firstChild.nodeValue = val[i];
      }
    }

    updateDate();
    function showSettings() {
      const setting = document.querySelector(".settings");
      setting.classList.toggle("show");
    }
    // JavaScript to toggle modal visibility
    document
      .getElementById("openModalButton")
      .addEventListener("click", function () {
        var modal = document.getElementById("composeEmailModal");
        modal.style.display =
          modal.style.display === "none" || modal.style.display === ""
            ? "block"
            : "none";
      });

    // Optional: Add a close button functionality
    document
      .getElementById("closeModalButton")
      .addEventListener("click", function () {
        document.getElementById("composeEmailModal").style.display = "none";
      });
    const emailInput = document.getElementById("emailInput");
    const emailList = document.getElementById("emailList");

    // Event listener for adding email addresses
    emailInput.addEventListener("keydown", handleKeyDown);

    function handleKeyDown(event) {
      const key = event.key;
      const inputValue = emailInput.value.trim();

      // Check if the key pressed is comma or Enter
      if (key === "," || key === "Enter") {
        // Prevent default behavior
        event.preventDefault();

        // Split the input value into individual email addresses if it contains commas
        const emails = inputValue.split(",").map((email) => email.trim());

        // Add each email address to the list
        emails.forEach((email) => addEmailToList(email));

        // Clear the input field
        emailInput.value = "";
      }
    }

    // Function to add email address to the list
    function addEmailToList(email) {
      // If the email address is not empty
      if (email !== "") {
        // Create a new email element
        const emailElement = document.createElement("span");
        emailElement.textContent = email;
        emailElement.classList.add("email");

        // Create a remove symbol element
        const removeSymbol = document.createElement("span");
        removeSymbol.textContent = "✕";
        removeSymbol.classList.add("remove-symbol");

        // Append the remove symbol to the email element
        emailElement.appendChild(removeSymbol);

        // Append the email element to the email list
        emailList.appendChild(emailElement);

        // Add event listener to remove the email element
        removeSymbol.addEventListener("click", () => {
          emailList.removeChild(emailElement);
        });
      }
    }

    // Function to gather all entered email addresses, subject, and content
    function gatherEmailData() {
      // Get the subject from the textarea
      const subject = document.getElementById("emailSubject").value;

      // Get the content from the TinyMCE editor if it's active
      let content = "";
      if (tinymce.activeEditor) {
        content = tinymce.activeEditor.getContent();
      }
      // Get all the email spans within the emailList container
      const emailSpans = document.querySelectorAll("#emailList .email");

      console.log("Number of email spans:", emailSpans.length);

      // Create an array to store the email addresses
      const emailAddresses = [];

      // Iterate through each email span and extract the email address
      emailSpans.forEach((emailSpan) => {
        console.log("Email span textContent:", emailSpan.textContent);
        const emailAddress = emailSpan.textContent.trim();
        emailAddresses.push(emailAddress);
      });

      console.log("Email addresses:", emailAddresses);

      // Return an object containing the subject, content, and email addresses
      return {
        subject: subject,
        content: content,
        emailAddresses: emailAddresses,
      };
    }

    function FireForm() {
      const formData = gatherEmailData();
      // Remove trailing 'x' from each email address
      const cleanedEmailAddresses = formData.emailAddresses.map((email) =>
        email.replace(/✕$/, "")
      );
      // Convert the cleaned email addresses array to a string
      const emailString = cleanedEmailAddresses.join(", ");
      // Set the value of the input field
      console.log(emailString);
      document.querySelector("#Allemails").value = JSON.stringify(emailString);
    }
  </script>
  <!-- the scripts ends here  -->
</html>
<!-- end of the page  -->
